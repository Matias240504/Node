<!DOCTYPE html>
<html lang="es">
<head>
    <%- include('./partials/styles', {title: 'Dashboard Juez'}) %>
    <style>
        /* Estilos adicionales para el dashboard del abogado */
        .btn-detalle {
            padding: 8px 12px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .btn-detalle:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
        }
        
        .btn-detalle:active {
            transform: translateY(1px);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .btn-detalle i {
            font-size: 0.8rem;
        }
        
        .btn-link {
            padding: 8px 12px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-decoration: none;
        }
        
        .btn-link:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
            color: white;
            text-decoration: none;
        }
        
        .btn-link:active {
            transform: translateY(1px);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .btn-link i {
            font-size: 0.8rem;
        }
        .user-info {
            margin-top: auto;
            padding-top: var(--spacing-md);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            position: relative;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: var(--spacing-sm);
        }
        
        .logout-btn {
            position: absolute;
            right: 0;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            font-size: 1.2rem;
            transition: color 0.3s;
        }
        
        .logout-btn:hover {
            color: white;
        }
        
        /* Estilos para insignias de asignación */
        .assigned-badge {
            display: inline-block;
            margin-left: 8px;
            padding: 4px 10px;
            font-size: 0.7rem;
            background-color: var(--primary-light);
            color: var(--primary-color);
            border-radius: 10px;
            font-weight: 600;
            border: 1px solid var(--primary-color);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .assigned-badge.other {
            background-color: var(--secondary-color);
            color: white;
            border: none;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <%- include('./partials/sidebar', {currentPath: '/juez/dashboard', user: user}) %>
        
        <!-- Main Content -->
        <div class="main-content">
            <div class="page-header">
                <h2 class="page-title">Dashboard de Juez</h2>
                <div>
                    <span id="currentDate"></span>
                </div>
            </div>
            
            <!-- Stats Cards -->
            <div class="cards-container">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Usuarios Totales</h3>
                        <div class="card-icon" style="background-color: var(--secondary-color);">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                    <div class="card-value"><%= estadisticas?.usuariosTotales ?? 0 %></div>
                    <div class="card-description">Usuarios registrados en el sistema</div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Casos Activos</h3>
                        <div class="card-icon" style="background-color: var(--primary-color);">
                            <i class="fas fa-briefcase"></i>
                        </div>
                    </div>
                    <div class="card-value"><%= estadisticas?.casosActivos ?? 0 %></div>
                    <div class="card-description">Casos en proceso</div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Audiencias Próximas</h3>
                        <div class="card-icon" style="background-color: var(--success-color);">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                    </div>
                    <div class="card-value"><%= estadisticas?.audienciasProximas ?? 0 %></div>
                    <div class="card-description">Audiencias programadas</div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Reportes</h3>
                        <div class="card-icon" style="background-color: var(--dark-color);">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                    </div>
                    <div class="card-value"><%= estadisticas?.reportes ?? 0 %></div>
                    <div class="card-description">Reportes generados</div>
                </div>
            </div>
            
            <!-- Usuarios recientes (para cambiar rol) -->
            <div class="section">
                <div class="section-header">
                    <h3 class="section-title">Usuarios Recientes</h3>
                    <a href="/juez/usuarios"><button>Ver todos <i class="fas fa-arrow-right"></i></button></a>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Rol</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                        <% if (usuarios && usuarios.length > 0) { %>
                            <% usuarios.slice(0, 5).forEach(function(usuario) { %>
                            <tr>
                                <td><%= usuario.nombre %> <%= usuario.apellido %></td>
                                <td><%= usuario.email %></td>
                                <td>
                                    <span class="badge role-<%= usuario.rol %>"><%= usuario.rol.charAt(0).toUpperCase() + usuario.rol.slice(1) %></span>
                                </td>
                                <td>
                                    <% 
                                        var estado = usuario.estado || 'activo';
                                    %>
                                    <span class="status status-<%= estado %>">
                                        <%= estado.charAt(0).toUpperCase() + estado.slice(1) %>
                                    </span>
                                </td>
                                <td>
                                    <a href="/juez/cambiarRol/<%= usuario._id %>" class="btn-link"><i class="fas fa-user-tag"></i> Cambiar Rol</a>
                                </td>
                            </tr>
                            <% }); %>
                        <% } else { %>
                            <tr>
                                <td colspan="5" style="text-align: center;">No hay usuarios recientes</td>
                            </tr>
                        <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Placeholder para Reportes -->
            <div class="section">
                <div class="section-header">
                    <h3 class="section-title">Reportes</h3>
                    <a href="/juez/reportes"><button>Ver todos <i class="fas fa-arrow-right"></i></button></a>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Reporte</th>
                                <th>Fecha</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="4" style="text-align: center;">Funcionalidad próximamente disponible</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Placeholder para Configuración -->
            <div class="section">
                <div class="section-header">
                    <h3 class="section-title">Configuración</h3>
                    <a href="/juez/configuracion"><button>Ir a configuración <i class="fas fa-cog"></i></button></a>
                </div>
                <div class="table-container">
                    <table>
                        <tbody>
                            <tr>
                                <td style="text-align: center;">Configuraciones y ajustes del sistema estarán aquí.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Mostrar fecha actual
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        const today = new Date();
        document.getElementById('currentDate').textContent = today.toLocaleDateString('es-ES', options);
    </script>
    <!-- Puedes agregar scripts específicos aquí -->
</body>
</html>
